{"title":"Examples","markdown":{"yaml":{"title":"Examples","format":"html"},"headingText":"load package","containsRefs":false,"markdown":"\n\n\n\n\n\n\n```{r}\n#| echo: fenced\n#| eval: false\n\nlibrary(tidyverse)\n\n# define toy dataset in the long data format\ndf <- tribble(\n    ~subject_id, ~question_id, ~question_text, ~answer, \n    \"s001\",   1, \"How old are you?\", \"23\", \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", \n    \"s002\",   1, \"How old are you?\", \"37\",\n    \"s002\",   2, \"Do you like cinnamon?\", \"no\", \n)\n\n# reshape the long data into the wide data format \ndf_wide <- df |> pivot_wider(id_cols = subject_id, \n                   names_from = question_id, \n                   values_from = c(question_text, answer))\n```\n\n**Code Chunk 1.** Reshaping data from long to wide is a breeze with the `pivot_wider()` function from the tidyverse package. Note that there is also a `pivot_longer()` function for the reverse reshaping operation.\n\n\n\nFurthermore, while Rule 3 states that data about different observational units should be organized in separate tables, there are of course situations where one needs to combine data from separate tables (e.g., did people from different ages respond differently to a given question?) Again, with the appropriate tooling, it is straightforward to join two tables, provided they share columns (i.e., keys; for an example of code sample joining two tables in R using the tidyverse package, see code chunk 2 and its output Table 3).\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy datasets\n# -- people's responses\n# we'll use the \"df\" table defined earlier\n\n# -- demographic data\ndemographics <- tribble(\n  ~subject_id, ~is_married, ~gender, ~ses_level, \n  \"s001\",   FALSE, \"male\", 4, \n  \"s002\",   TRUE, \"female\", 8, \n)\n\n# join data tables\ndf_joined <- left_join(df, demographics, by = \"subject_id\")\n```\n\n**Code Chunk 2.** Joining data tables with shared keys. In this example we use the `left_join()` function from the tidyverse package in R to join a demographics table to a questionnaire data table (wide format) using `subject_id` as the key to map entries across the two tables. \n\n\n\n\n```{r}\ndf_joined\n```\n\nSTOPPED HERE\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy dataset\ndf_long <- tribble(\n    ~subject_id, ~question_id, ~question, ~answer, ~repetition,\n    \"s001\",   1, \"How old are you?\", \"23\", 1,\n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 1, \n    \"s002\",   1, \"How old are you?\", \"37\", 1, \n    \"s002\",   2, \"Do you like cinnamon?\", \"no\", 1, \n    \"s001\",   1, \"How old are you?\", \"23\", 2, \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 2,  \n    \"s002\",   1, \"How old are you?\", \"37\", 2, \n    \"s002\",   2, \"Do you like cinnamon?\", \"yes\", 2, \n    \"s001\",   1, \"How old are you?\", \"23\", 3, \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 3, \n)\n\n# create a \"wide\" version of the dataset\ndf_wide <- df_long |> \n  mutate(question_id = paste0('q', question_id), \n         repetition = paste0('r', repetition)) |> \n  pivot_wider(names_from = c(question_id, repetition), \n              values_from = c(question, answer),\n              names_glue = \"{question_id}_{.value}_{repetition}\")\n\n\n## Goal: get all data corresponding to question 1 or to second repetitions\n\n# -- under wide format:\ndf_wide |> select(matches(\"^q1_\"))\ndf_wide |> select(matches(\"r2$\"))\n\n# -- under the long format\ndf_long |> filter(question_id == 1)\ndf_long |> filter(repetition == 2)\n\n```\n\n**Code Chunk 3.** Selecting and filtering data under the wide vs long data format. Note that in this example, the operations remain rather simple because we used a consistent column naming scheme and tidyverse offers effective column selection tools. It is likely that when using other tools for data analysis (e.g., Excel) these difficulties will be much more salient.\n\n\n\n\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy dataset\nquiz_data <- tribble(\n  ~subject_id, ~question_id, ~question_text, ~answer, ~score,   \n  \"s001\",   \"q10\", \"What is the capital of France?\", \"Paris\", 1,\n  \"s001\",   \"q11\", \"What is the capital of Luxembourg?\", \"Luxembourg\", 1,\n  \"s001\",   \"q12\", \"When was Leanoardo da Vinci born?\", \"1452\", 1,\n  \"s002\",   \"q10\", \"What is the capital of France?\", \"Paris\", 1,\n  \"s002\",   \"q11\", \"What is the capital of Luxembourg?\", NA, 0,\n  \"s002\",   \"q12\", \"When was Leanoardo da Vinci born?\", \"1900\", 0,\n)\n\n# code to score quiz responses: this code could be separate from the data analysis script and reused on other datasets.\nmy_scoring_function <- function(q10, q11){\n  0.8 * q10 + 1.2 * q11\n}\n\n\n# computing scores typically follows this blueprint;\nscores <- quiz_data |>  \n  # reshape data to wide format\n  pivot_wider(id_cols = subject_id, \n\t\t\t  names_from = question_id,\n\t\t\t  values_from = c(score)) |> \n  \n  # apply scoring function \n  mutate(score = my_scoring_function(q10, q11)) |> \n  \n  # retain only relevant columns\n  select(subject_id, score)\n\nprint(scores)\n```\n\n\n**Code Chunk 4.** Example code demonstrating how to compute a score from a set of questions under the long data format in R using the tidyverse package.\n\n\n \n \n ","srcMarkdownNoYaml":"\n\n\n\n\n\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# load package\nlibrary(tidyverse)\n\n# define toy dataset in the long data format\ndf <- tribble(\n    ~subject_id, ~question_id, ~question_text, ~answer, \n    \"s001\",   1, \"How old are you?\", \"23\", \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", \n    \"s002\",   1, \"How old are you?\", \"37\",\n    \"s002\",   2, \"Do you like cinnamon?\", \"no\", \n)\n\n# reshape the long data into the wide data format \ndf_wide <- df |> pivot_wider(id_cols = subject_id, \n                   names_from = question_id, \n                   values_from = c(question_text, answer))\n```\n\n**Code Chunk 1.** Reshaping data from long to wide is a breeze with the `pivot_wider()` function from the tidyverse package. Note that there is also a `pivot_longer()` function for the reverse reshaping operation.\n\n\n\nFurthermore, while Rule 3 states that data about different observational units should be organized in separate tables, there are of course situations where one needs to combine data from separate tables (e.g., did people from different ages respond differently to a given question?) Again, with the appropriate tooling, it is straightforward to join two tables, provided they share columns (i.e., keys; for an example of code sample joining two tables in R using the tidyverse package, see code chunk 2 and its output Table 3).\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy datasets\n# -- people's responses\n# we'll use the \"df\" table defined earlier\n\n# -- demographic data\ndemographics <- tribble(\n  ~subject_id, ~is_married, ~gender, ~ses_level, \n  \"s001\",   FALSE, \"male\", 4, \n  \"s002\",   TRUE, \"female\", 8, \n)\n\n# join data tables\ndf_joined <- left_join(df, demographics, by = \"subject_id\")\n```\n\n**Code Chunk 2.** Joining data tables with shared keys. In this example we use the `left_join()` function from the tidyverse package in R to join a demographics table to a questionnaire data table (wide format) using `subject_id` as the key to map entries across the two tables. \n\n\n\n\n```{r}\ndf_joined\n```\n\nSTOPPED HERE\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy dataset\ndf_long <- tribble(\n    ~subject_id, ~question_id, ~question, ~answer, ~repetition,\n    \"s001\",   1, \"How old are you?\", \"23\", 1,\n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 1, \n    \"s002\",   1, \"How old are you?\", \"37\", 1, \n    \"s002\",   2, \"Do you like cinnamon?\", \"no\", 1, \n    \"s001\",   1, \"How old are you?\", \"23\", 2, \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 2,  \n    \"s002\",   1, \"How old are you?\", \"37\", 2, \n    \"s002\",   2, \"Do you like cinnamon?\", \"yes\", 2, \n    \"s001\",   1, \"How old are you?\", \"23\", 3, \n    \"s001\",   2, \"Do you like cinnamon?\", \"yes\", 3, \n)\n\n# create a \"wide\" version of the dataset\ndf_wide <- df_long |> \n  mutate(question_id = paste0('q', question_id), \n         repetition = paste0('r', repetition)) |> \n  pivot_wider(names_from = c(question_id, repetition), \n              values_from = c(question, answer),\n              names_glue = \"{question_id}_{.value}_{repetition}\")\n\n\n## Goal: get all data corresponding to question 1 or to second repetitions\n\n# -- under wide format:\ndf_wide |> select(matches(\"^q1_\"))\ndf_wide |> select(matches(\"r2$\"))\n\n# -- under the long format\ndf_long |> filter(question_id == 1)\ndf_long |> filter(repetition == 2)\n\n```\n\n**Code Chunk 3.** Selecting and filtering data under the wide vs long data format. Note that in this example, the operations remain rather simple because we used a consistent column naming scheme and tidyverse offers effective column selection tools. It is likely that when using other tools for data analysis (e.g., Excel) these difficulties will be much more salient.\n\n\n\n\n\n```{r}\n#| echo: fenced\n#| eval: false\n\n# create toy dataset\nquiz_data <- tribble(\n  ~subject_id, ~question_id, ~question_text, ~answer, ~score,   \n  \"s001\",   \"q10\", \"What is the capital of France?\", \"Paris\", 1,\n  \"s001\",   \"q11\", \"What is the capital of Luxembourg?\", \"Luxembourg\", 1,\n  \"s001\",   \"q12\", \"When was Leanoardo da Vinci born?\", \"1452\", 1,\n  \"s002\",   \"q10\", \"What is the capital of France?\", \"Paris\", 1,\n  \"s002\",   \"q11\", \"What is the capital of Luxembourg?\", NA, 0,\n  \"s002\",   \"q12\", \"When was Leanoardo da Vinci born?\", \"1900\", 0,\n)\n\n# code to score quiz responses: this code could be separate from the data analysis script and reused on other datasets.\nmy_scoring_function <- function(q10, q11){\n  0.8 * q10 + 1.2 * q11\n}\n\n\n# computing scores typically follows this blueprint;\nscores <- quiz_data |>  \n  # reshape data to wide format\n  pivot_wider(id_cols = subject_id, \n\t\t\t  names_from = question_id,\n\t\t\t  values_from = c(score)) |> \n  \n  # apply scoring function \n  mutate(score = my_scoring_function(q10, q11)) |> \n  \n  # retain only relevant columns\n  select(subject_id, score)\n\nprint(scores)\n```\n\n\n**Code Chunk 4.** Example code demonstrating how to compute a score from a set of questions under the long data format in R using the tidyverse package.\n\n\n \n \n "},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"code_chunks.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.39","title":"Examples"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["pdf"]}